# Скрипт для разбора логов

### Используемые модули и библиотеки

* Основной код написан на Python3
* В качестве базы данных для хранения результатов парсинга используется БД SQLite
* Запросы в БД пишутся не напрямую, а с использованием ORM [peewee](http://docs.peewee-orm.com/en/latest/peewee/quickstart.html)

### Принцип работы

Сначала запускается скрипт step1_parser.py. 

```bash
python3 step1_parser.py
``` 

Этот скрипт построчно читает основной файл логов.
Каждую строчку из файла он сначала разбивает на 3 части:
* текст запроса - в виде списка из слов, составляющих запрос
* дата запроса
* время запроса

Затем для каждого слова из текста запроса создается свой уникальный идентификатор контекста, по которому впоследсивии 
можно будет восстановить весь запрос целиком. И далее каждое слово из запроса сохраняется в виде отдельной строки в БД
в таблице `searchrequest` 

Файл с логами парсится в БД database/initial.db. Из-за большого размера файла это долгий процесс,
поэтому на данном этапе в БД импортировано только 86998 поисковых запросов

### Осуществление запросов к БД с целью аналитики

Достаточно мелкое разбиение поисковых запросов на отдельные слова и временные метки позволит нам писать запросы к БД,
которые позволят ответить на множество самых разнообразных вопросов. В качестве примера в файле `main.py` приведены
4 запроса к БД, проливающие свет на вопросы:

* В день матча Испания - Португалия за какую страну болели больше?
* Сколько запросов со словом "билет" было в день матча Испания-Португалия?
* Сколько людей хотели купить билет в день матча "Испания-Португалия"?